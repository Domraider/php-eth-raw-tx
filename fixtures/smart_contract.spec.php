<?php

describe("Smart contract ", function () {

    beforeEach(function(){
        $smartContractBinaries = "6060604052341561000f57600080fd5b604051606080610be483398101604052808051906020019091908051906020019091908051906020019091905050826002819055508160018190555080600081905550806004819055506000600360006101000a81548160ff0219169083151502179055507f0114aab713235b737f82de882833e128d244e12c1b0967b9c49748c123a6f4b183838360405180848152602001838152602001828152602001935050505060405180910390a1505050610b17806100cd6000396000f3006060604052600436106100e6576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630b97bc86146100eb5780630f76787214610114578063164418131461013d5780632014e5d1146101745780634423c5f1146101a1578063454a2ab31461021d5780634c051f1414610258578063544736e6146102ad5780636f52a711146102da5780637b3529621461030357806382dd9b7714610330578063971c92a814610360578063bef4876b14610389578063c24a0f8b146103b6578063e53dbd7a146103df578063efbe1c1c14610408575b600080fd5b34156100f657600080fd5b6100fe610435565b6040518082815260200191505060405180910390f35b341561011f57600080fd5b61012761043b565b6040518082815260200191505060405180910390f35b341561014857600080fd5b610150610441565b60405180848152602001838152602001828152602001935050505060405180910390f35b341561017f57600080fd5b61018761045a565b604051808215151515815260200191505060405180910390f35b34156101ac57600080fd5b6101c2600480803590602001909190505061047a565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018481526020018381526020018215151515815260200194505050505060405180910390f35b341561022857600080fd5b61023e60048080359060200190919050506104e6565b604051808215151515815260200191505060405180910390f35b341561026357600080fd5b61026b6107e6565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156102b857600080fd5b6102c0610890565b604051808215151515815260200191505060405180910390f35b34156102e557600080fd5b6102ed61089d565b6040518082815260200191505060405180910390f35b341561030e57600080fd5b6103166108a3565b604051808215151515815260200191505060405180910390f35b341561033b57600080fd5b6103436108c6565b604051808381526020018281526020019250505060405180910390f35b341561036b57600080fd5b61037361095e565b6040518082815260200191505060405180910390f35b341561039457600080fd5b61039c610963565b604051808215151515815260200191505060405180910390f35b34156103c157600080fd5b6103c9610976565b6040518082815260200191505060405180910390f35b34156103ea57600080fd5b6103f261097c565b6040518082815260200191505060405180910390f35b341561041357600080fd5b61041b610981565b604051808215151515815260200191505060405180910390f35b60015481565b60025481565b6000806000600154925060005491506004549050909192565b6000610464610890565b801561047557506104736108a3565b155b905090565b60058181548110151561048957fe5b90600052602060002090600402016000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010154908060020154908060030160009054906101000a900460ff16905084565b6000806104f16108c6565b9150506104fc61045a565b151561050b57600091506107e0565b8083101561063557600580548060010182816105279190610a4f565b916000526020600020906004020160006080604051908101604052803273ffffffffffffffffffffffffffffffffffffffff16815260200187815260200142815260200160001515815250909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015560608201518160030160006101000a81548160ff0219169083151502179055505050507f3f3880a3434edc55799b6fa2eb84de9f6b4364947a45ded791bac94deae3c0a1836040518082815260200191505060405180910390a1600091506107e0565b600580548060010182816106499190610a4f565b916000526020600020906004020160006080604051908101604052803273ffffffffffffffffffffffffffffffffffffffff16815260200187815260200142815260200160011515815250909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015560608201518160030160006101000a81548160ff0219169083151502179055505050507fd04f845137f741f1b1fcb8758a097aa384274dde474ea57dc4b71e88f8625cf3838232604051808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a160b4600054034211156107db5760b442016000819055507fe95bc45419aec7c2c587ae26906bc5d0cd55ce4237d73476f63bc13b36b149556000546040518082815260200191505060405180910390a15b600191505b50919050565b60008060058054905090505b60008114151561088b5760056001820381548110151561080e57fe5b906000526020600020906004020160030160009054906101000a900460ff161561087d5760056001820381548110151561084457fe5b906000526020600020906004020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16915061088c565b8080600190039150506107f2565b5b5090565b6000600154421015905090565b60045481565b6000600360009054906101000a900460ff16806108c1575060005442115b905090565b600080600060058054905090505b600081141515610953576005600182038154811015156108f057fe5b906000526020600020906004020160030160009054906101000a900460ff16156109455760056001820381548110151561092657fe5b9060005260206000209060040201600101549250600183019150610959565b8080600190039150506108d4565b60025491505b509091565b60b481565b600360009054906101000a900460ff1681565b60005481565b60b481565b600080600360009054906101000a900460ff16806109a0575060005442105b156109ae5760009150610a4b565b6001600360006101000a81548160ff0219169083151502179055506109d16108c6565b5090507f8b1ad6c69d3d79a05f5b1ec0de825e9bf67c6c70b8c25babd159976cf9990dff6109fd6107e6565b82604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a1600191505b5090565b815481835581811511610a7c57600402816004028360005260206000209182019101610a7b9190610a81565b5b505050565b610ae891905b80821115610ae457600080820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055600182016000905560028201600090556003820160006101000a81549060ff021916905550600401610a87565b5090565b905600a165627a7a72305820754c1010acd9d786231fb46d9cddd36ece3750a041ba8f62c211cccbe25c2c200029";
        $smartContractAbi = "[{\"constant\":true,\"inputs\":[],\"name\":\"startDate\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"startAmount\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getDates\",\"outputs\":[{\"name\":\"_startDate\",\"type\":\"uint256\"},{\"name\":\"_endDate\",\"type\":\"uint256\"},{\"name\":\"_originalEndDate\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"isRunning\",\"outputs\":[{\"name\":\"_running\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"bids\",\"outputs\":[{\"name\":\"user\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"date\",\"type\":\"uint256\"},{\"name\":\"accepted\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"bid\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getLeader\",\"outputs\":[{\"name\":\"_leader\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"isStarted\",\"outputs\":[{\"name\":\"_started\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"originalEndDate\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"isFinished\",\"outputs\":[{\"name\":\"_finished\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCurrentAmounts\",\"outputs\":[{\"name\":\"_current\",\"type\":\"uint256\"},{\"name\":\"_minimal\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"antiSnippingTriggerPeriod\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"finished\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"endDate\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"antiSnippingDuration\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"end\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_startAmount\",\"type\":\"uint256\"},{\"name\":\"_startDate\",\"type\":\"uint256\"},{\"name\":\"_endDate\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"startAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"startDate\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"endDate\",\"type\":\"uint256\"}],\"name\":\"NewAuction\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"winner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"AuctionFinished\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_minimal\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"origin\",\"type\":\"address\"}],\"name\":\"BidAccepted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"BidRejected\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"endDate\",\"type\":\"uint256\"}],\"name\":\"AntiSnippingTriggered\",\"type\":\"event\"}]";

        $this->sc = new \EthereumRawTx\SmartContract($smartContractBinaries, $smartContractAbi);

        $smartContractDrtAbi = "[{\"constant\":true,\"inputs\":[],\"name\":\"DEFROST_MONTHLY_PERCENT_OWNER\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_spender\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DEFROST_INITIAL_PERCENT_OWNER\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"batchAssignStopped\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalSupply\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"stopBatchAssign\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"decimals\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"addr\",\"type\":\"address\"}],\"name\":\"getAddressBalance\",\"outputs\":[{\"name\":\"balance\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"elapsedMonthsFromICOStart\",\"outputs\":[{\"name\":\"elapsed\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"canDefrost\",\"outputs\":[{\"name\":\"bCanDefrost\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_spender\",\"type\":\"address\"},{\"name\":\"_subtractedValue\",\"type\":\"uint256\"}],\"name\":\"decreaseApproval\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"name\":\"balance\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DEFROST_INITIAL_PERCENT\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"START_ICO_TIMESTAMP\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getBlockTimestamp\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getOwnerInfos\",\"outputs\":[{\"name\":\"owneraddr\",\"type\":\"address\"},{\"name\":\"balance\",\"type\":\"uint256\"},{\"name\":\"frosted\",\"type\":\"uint256\"},{\"name\":\"defrosted\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DEFROST_MONTHLY_PERCENT\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"MAX_SUPPLY_OF_TOKEN\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"assignedSupply\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DEFROST_PERIOD\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"defrostToken\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"addr\",\"type\":\"address\"}],\"name\":\"getIcedInfos\",\"outputs\":[{\"name\":\"icedaddr\",\"type\":\"address\"},{\"name\":\"balance\",\"type\":\"uint256\"},{\"name\":\"frosted\",\"type\":\"uint256\"},{\"name\":\"defrosted\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_spender\",\"type\":\"address\"},{\"name\":\"_addedValue\",\"type\":\"uint256\"}],\"name\":\"increaseApproval\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_spender\",\"type\":\"address\"}],\"name\":\"allowance\",\"outputs\":[{\"name\":\"remaining\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"addr\",\"type\":\"address\"}],\"name\":\"getAddressAndBalance\",\"outputs\":[{\"name\":\"_address\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getIcedAddresses\",\"outputs\":[{\"name\":\"vaddr\",\"type\":\"address[]\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_vaddr\",\"type\":\"address[]\"},{\"name\":\"_vamounts\",\"type\":\"uint256[]\"},{\"name\":\"_vIcedBalance\",\"type\":\"bool[]\"}],\"name\":\"batchAssignTokens\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"defrostOwner\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"spender\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"}]";
        $smartContractDrtBinaries = "60606040526000600a60006101000a81548160ff021916908315150217905550341561002a57600080fd5b5b6000805b33600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b33600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506008600a0a63207c0a400291506064600a83028115156100ce57fe5b0490508060016000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550806008819055508082036007819055506008600a0a634d7c6d0002600081905550816009819055505b50505b6125a4806101726000396000f300606060405236156101aa576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630547bf4d146101af57806306fdde03146101d8578063095ea7b3146102675780630dcc59e6146102c15780630f6413b7146102ea57806318160ddd146103175780631986bc551461034057806323b872dd14610355578063313ce567146103ce57806335046722146103f75780635600e8271461044457806363b3c0071461046d578063661884631461049a57806370a08231146104f457806374f79c8e1461054157806375b3a83e1461056a578063796b89b9146105935780638a6281f6146105bc5780638da5cb5b146106265780638e44e74e1461067b57806395d89b41146106a4578063a9059cbb14610733578063ad71a1fd1461078d578063b1efeece146107b6578063c1615c87146107df578063cb89902414610808578063d6a152311461081d578063d73dd623146108ab578063dd62ed3e14610905578063e799059614610971578063f2fde38b146109f1578063f6e898b014610a2a578063fadf4cb214610a95578063fc143f2b14610b6f575b600080fd5b34156101ba57600080fd5b6101c2610b84565b6040518082815260200191505060405180910390f35b34156101e357600080fd5b6101eb610b89565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561022c5780820151818401525b602081019050610210565b50505050905090810190601f1680156102595780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561027257600080fd5b6102a7600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610bc2565b604051808215151515815260200191505060405180910390f35b34156102cc57600080fd5b6102d4610d4a565b6040518082815260200191505060405180910390f35b34156102f557600080fd5b6102fd610d4f565b604051808215151515815260200191505060405180910390f35b341561032257600080fd5b61032a610d62565b6040518082815260200191505060405180910390f35b341561034b57600080fd5b610353610d68565b005b341561036057600080fd5b6103b4600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610e05565b604051808215151515815260200191505060405180910390f35b34156103d957600080fd5b6103e16110f2565b6040518082815260200191505060405180910390f35b341561040257600080fd5b61042e600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506110f7565b6040518082815260200191505060405180910390f35b341561044f57600080fd5b610457611141565b6040518082815260200191505060405180910390f35b341561047857600080fd5b610480611169565b604051808215151515815260200191505060405180910390f35b34156104a557600080fd5b6104da600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506111d5565b604051808215151515815260200191505060405180910390f35b34156104ff57600080fd5b61052b600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611467565b6040518082815260200191505060405180910390f35b341561054c57600080fd5b6105546114b1565b6040518082815260200191505060405180910390f35b341561057557600080fd5b61057d6114b6565b6040518082815260200191505060405180910390f35b341561059e57600080fd5b6105a66114be565b6040518082815260200191505060405180910390f35b34156105c757600080fd5b6105cf6114c7565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184815260200183815260200182815260200194505050505060405180910390f35b341561063157600080fd5b610639611545565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561068657600080fd5b61068e61156b565b6040518082815260200191505060405180910390f35b34156106af57600080fd5b6106b7611570565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156106f85780820151818401525b6020810190506106dc565b50505050905090810190601f1680156107255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561073e57600080fd5b610773600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506115a9565b604051808215151515815260200191505060405180910390f35b341561079857600080fd5b6107a0611780565b6040518082815260200191505060405180910390f35b34156107c157600080fd5b6107c961178e565b6040518082815260200191505060405180910390f35b34156107ea57600080fd5b6107f2611794565b6040518082815260200191505060405180910390f35b341561081357600080fd5b61081b61179a565b005b341561082857600080fd5b610854600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611aff565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184815260200183815260200182815260200194505050505060405180910390f35b34156108b657600080fd5b6108eb600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050611bd6565b604051808215151515815260200191505060405180910390f35b341561091057600080fd5b61095b600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611dd3565b6040518082815260200191505060405180910390f35b341561097c57600080fd5b6109a8600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611e5b565b604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390f35b34156109fc57600080fd5b610a28600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611ea9565b005b3415610a3557600080fd5b610a3d611f87565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b83811015610a815780820151818401525b602081019050610a65565b505050509050019250505060405180910390f35b3415610aa057600080fd5b610b6d600480803590602001908201803590602001908080602002602001604051908101604052809392919081815260200183836020028082843782019150505050505091908035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509190505061201c565b005b3415610b7a57600080fd5b610b82612322565b005b600581565b6040805190810160405280600e81526020017f446f6d526169646572546f6b656e00000000000000000000000000000000000081525081565b600080821480610c4e57506000600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054145b1515610c5957600080fd5b81600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925846040518082815260200191505060405180910390a3600190505b92915050565b600a81565b600a60009054906101000a900460ff1681565b60005481565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610dc457600080fd5b60001515600a60009054906101000a900460ff161515141515610de657600080fd5b6001600a60006101000a81548160ff0219169083151502179055505b5b565b600080600073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1614151515610e4457600080fd5b600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050610f1583600160008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546124bc90919063ffffffff16565b600160008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550610faa83600160008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546124d690919063ffffffff16565b600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061100083826124bc90919063ffffffff16565b600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508373ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef856040518082815260200191505060405180910390a3600191505b509392505050565b600881565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b919050565b600061a8c0603c6359dc7e00420381151561115857fe5b0481151561116257fe5b0490505b90565b6000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156111c757600080fd5b6359dc7e00421190505b5b90565b600080600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050808311156112e6576000600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061137a565b6112f983826124bc90919063ffffffff16565b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b8373ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546040518082815260200191505060405180910390a3600191505b5092915050565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b919050565b601481565b6359dc7e0081565b60004290505b90565b600080600080600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169350600160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549250600754915060085490505b90919293565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600a81565b6040805190810160405280600381526020017f445254000000000000000000000000000000000000000000000000000000000081525081565b60008073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16141515156115e657600080fd5b61163882600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546124bc90919063ffffffff16565b600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506116cd82600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546124d690919063ffffffff16565b600160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040518082815260200191505060405180910390a3600190505b92915050565b6008600a0a634d7c6d000281565b60095481565b61a8c081565b6000806000806000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156117fe57600080fd5b6359dc7e004211151561181057600080fd5b600094505b600480549050851015611af65760048581548110151561183157fe5b906000526020600020900160005b9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169350600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020540192506064836118fe6064600a6118f5611141565b026014016124f5565b0281151561190857fe5b049150600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054820390506000811115611ae85780600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205403600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555080600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205401600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555080600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205401600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b5b8480600101955050611815565b5b5b5050505050565b600080600080849350600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549250600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549150600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9193509193565b6000611c6782600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546124d690919063ffffffff16565b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546040518082815260200191505060405180910390a3600190505b92915050565b6000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b92915050565b600080829150600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b915091565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515611f0557600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614151515611f4157600080fd5b80600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b50565b611f8f612513565b600480548060200260200160405190810160405280929190818152602001828054801561201157602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311611fc7575b505050505090505b90565b6000806000806000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561208057600080fd5b60001515600a60009054906101000a900460ff1615151415156120a257600080fd5b865188511415156120b257600080fd5b600094505b87518510156123165787858151811015156120ce57fe5b9060200190602002015193506008600a0a87868151811015156120ed57fe5b90602001906020020151029250858581518110151561210857fe5b9060200190602002015191506000600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054141561230857826009600082825401925050819055506000151582151514156121c25782600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550612307565b600480548060010182816121d69190612527565b916000526020600020900160005b86909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505060646014840281151561223557fe5b04905080600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555080600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550808303600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b5b5b84806001019550506120b7565b5b5b5050505050505050565b6000806000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561238357600080fd5b6359dc7e00421015612394576124b6565b6008546007540192506064836123b8606460056123af611141565b02600a016124f5565b028115156123c257fe5b0491506008548203905060008111156124b557806007540360078190555080600854016008819055508060016000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020540160016000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b5b5b505050565b60008282111515156124ca57fe5b81830390505b92915050565b60008082840190508381101515156124ea57fe5b8091505b5092915050565b600081831115156125085782905061250c565b8190505b5b92915050565b602060405190810160405280600081525090565b81548183558181151161254e5781836000526020600020918201910161254d9190612553565b5b505050565b61257591905b80821115612571576000816000905550600101612559565b5090565b905600a165627a7a72305820149cbc4f34b50bf9938e2d5d60b99a0ac353e18728cddbf2dfec0004d243263d0029";
        $this->scDrt = new \EthereumRawTx\SmartContract($smartContractDrtBinaries, $smartContractDrtAbi);

        $this->chainId = \BitWasp\Buffertools\Buffer::int(4); // rinkeby

        $this->privateKey = BitWasp\Buffertools\Buffer::hex('0000000000000000000000000000000000000000000000000000000000000001');


    });

    it("Deploy", function () {

        $time = 1511775500; // timestamp

        $tx = new \EthereumRawTx\Transaction(
            null,
            null,
            $this->sc->getConstructBin([\BitWasp\Buffertools\Buffer::int(5), \BitWasp\Buffertools\Buffer::int($time), \BitWasp\Buffertools\Buffer::int($time + 86400)]),
            BitWasp\Buffertools\Buffer::int('0'),
            \BitWasp\Buffertools\Buffer::int(40000000000),
            \BitWasp\Buffertools\Buffer::int(1000000)
        );

        $raw = $tx->getRaw(BitWasp\Buffertools\Buffer::hex('0000000000000000000000000000000000000000000000000000000000000001'), $this->chainId);

        expect($raw->getHex())->to->equal('f90c97808509502f9000830f42408080b90c446060604052341561000f57600080fd5b604051606080610be483398101604052808051906020019091908051906020019091908051906020019091905050826002819055508160018190555080600081905550806004819055506000600360006101000a81548160ff0219169083151502179055507f0114aab713235b737f82de882833e128d244e12c1b0967b9c49748c123a6f4b183838360405180848152602001838152602001828152602001935050505060405180910390a1505050610b17806100cd6000396000f3006060604052600436106100e6576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630b97bc86146100eb5780630f76787214610114578063164418131461013d5780632014e5d1146101745780634423c5f1146101a1578063454a2ab31461021d5780634c051f1414610258578063544736e6146102ad5780636f52a711146102da5780637b3529621461030357806382dd9b7714610330578063971c92a814610360578063bef4876b14610389578063c24a0f8b146103b6578063e53dbd7a146103df578063efbe1c1c14610408575b600080fd5b34156100f657600080fd5b6100fe610435565b6040518082815260200191505060405180910390f35b341561011f57600080fd5b61012761043b565b6040518082815260200191505060405180910390f35b341561014857600080fd5b610150610441565b60405180848152602001838152602001828152602001935050505060405180910390f35b341561017f57600080fd5b61018761045a565b604051808215151515815260200191505060405180910390f35b34156101ac57600080fd5b6101c2600480803590602001909190505061047a565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018481526020018381526020018215151515815260200194505050505060405180910390f35b341561022857600080fd5b61023e60048080359060200190919050506104e6565b604051808215151515815260200191505060405180910390f35b341561026357600080fd5b61026b6107e6565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156102b857600080fd5b6102c0610890565b604051808215151515815260200191505060405180910390f35b34156102e557600080fd5b6102ed61089d565b6040518082815260200191505060405180910390f35b341561030e57600080fd5b6103166108a3565b604051808215151515815260200191505060405180910390f35b341561033b57600080fd5b6103436108c6565b604051808381526020018281526020019250505060405180910390f35b341561036b57600080fd5b61037361095e565b6040518082815260200191505060405180910390f35b341561039457600080fd5b61039c610963565b604051808215151515815260200191505060405180910390f35b34156103c157600080fd5b6103c9610976565b6040518082815260200191505060405180910390f35b34156103ea57600080fd5b6103f261097c565b6040518082815260200191505060405180910390f35b341561041357600080fd5b61041b610981565b604051808215151515815260200191505060405180910390f35b60015481565b60025481565b6000806000600154925060005491506004549050909192565b6000610464610890565b801561047557506104736108a3565b155b905090565b60058181548110151561048957fe5b90600052602060002090600402016000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010154908060020154908060030160009054906101000a900460ff16905084565b6000806104f16108c6565b9150506104fc61045a565b151561050b57600091506107e0565b8083101561063557600580548060010182816105279190610a4f565b916000526020600020906004020160006080604051908101604052803273ffffffffffffffffffffffffffffffffffffffff16815260200187815260200142815260200160001515815250909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015560608201518160030160006101000a81548160ff0219169083151502179055505050507f3f3880a3434edc55799b6fa2eb84de9f6b4364947a45ded791bac94deae3c0a1836040518082815260200191505060405180910390a1600091506107e0565b600580548060010182816106499190610a4f565b916000526020600020906004020160006080604051908101604052803273ffffffffffffffffffffffffffffffffffffffff16815260200187815260200142815260200160011515815250909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015560608201518160030160006101000a81548160ff0219169083151502179055505050507fd04f845137f741f1b1fcb8758a097aa384274dde474ea57dc4b71e88f8625cf3838232604051808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a160b4600054034211156107db5760b442016000819055507fe95bc45419aec7c2c587ae26906bc5d0cd55ce4237d73476f63bc13b36b149556000546040518082815260200191505060405180910390a15b600191505b50919050565b60008060058054905090505b60008114151561088b5760056001820381548110151561080e57fe5b906000526020600020906004020160030160009054906101000a900460ff161561087d5760056001820381548110151561084457fe5b906000526020600020906004020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16915061088c565b8080600190039150506107f2565b5b5090565b6000600154421015905090565b60045481565b6000600360009054906101000a900460ff16806108c1575060005442115b905090565b600080600060058054905090505b600081141515610953576005600182038154811015156108f057fe5b906000526020600020906004020160030160009054906101000a900460ff16156109455760056001820381548110151561092657fe5b9060005260206000209060040201600101549250600183019150610959565b8080600190039150506108d4565b60025491505b509091565b60b481565b600360009054906101000a900460ff1681565b60005481565b60b481565b600080600360009054906101000a900460ff16806109a0575060005442105b156109ae5760009150610a4b565b6001600360006101000a81548160ff0219169083151502179055506109d16108c6565b5090507f8b1ad6c69d3d79a05f5b1ec0de825e9bf67c6c70b8c25babd159976cf9990dff6109fd6107e6565b82604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a1600191505b5090565b815481835581811511610a7c57600402816004028360005260206000209182019101610a7b9190610a81565b5b505050565b610ae891905b80821115610ae457600080820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055600182016000905560028201600090556003820160006101000a81549060ff021916905550600401610a87565b5090565b905600a165627a7a72305820754c1010acd9d786231fb46d9cddd36ece3750a041ba8f62c211cccbe25c2c2000290000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000005a1bdd0c000000000000000000000000000000000000000000000000000000005a1d2e8c2ca04a7aa5dbe4b9de6425985e9ff4d6bce59774d6f27c253127d943edb7ed9e3360a021519ac7fdc6c6c3f901af32308f69736bd2c841aa37d73e79b2e39180d9096b');

    });

    it("Decode response", function () {

        $responseRaw = "0x000000000000000000000000000000000000000000000000000000005a16e154000000000000000000000000000000000000000000000000000000005a1832d4000000000000000000000000000000000000000000000000000000005a1832d4";
        $reponseData = $this->sc->decodeMethodResponse("getDates", $responseRaw);

        expect($reponseData['_startDate']->getInt())->to->equal('1511448916');
        expect($reponseData['_endDate']->getInt())->to->equal('1511535316');
        expect($reponseData['_originalEndDate']->getInt())->to->equal('1511535316');

        $responseRaw = "0x000000000000000000000000e9875966d7d6490592db866f815faf6fa94225a6";
        $reponseData = $this->sc->decodeMethodResponse("getLeader", $responseRaw);

        expect($reponseData['_leader']->getHex())->to->equal('e9875966d7d6490592db866f815faf6fa94225a6');

        $responseRaw = "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005";
        $reponseData = $this->sc->decodeMethodResponse("getCurrentAmounts", $responseRaw);

        expect($reponseData['_current']->getInt())->to->equal('0');
        expect($reponseData['_minimal']->getInt())->to->equal('5');

    });

    it("Decode response event", function () {

        $responseRaw = json_decode('{"address":"0x31b83a851eb7112448d4837a071acabd83531f69","topics":["0xd04f845137f741f1b1fcb8758a097aa384274dde474ea57dc4b71e88f8625cf3"],"data":"0x000000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000026000000000000000000000000e78102df96419cd9c44d6bd8f14ea87712a3b479","blockNumber":"0x5577e","transactionHash":"0x1654c3343501d4cdb78ddd52da8e86c5f700ed13a8cdf71e7b6544b7483c8559","transactionIndex":"0x0","blockHash":"0x0b675c0fab32f0ab0221c309145b7b27571f335aa49518c05d71b4d8d1771a80","logIndex":"0x0","removed":false}',true);
        $reponseData = $this->sc->decodeEventResponse($responseRaw);

        expect($reponseData['eventName'])->to->equal('BidAccepted');
        expect($reponseData['data']['amount']->getInt())->to->equal('42');
        expect($reponseData['data']['_minimal']->getInt())->to->equal('38');
        expect($reponseData['data']['origin']->getHex())->to->equal('e78102df96419cd9c44d6bd8f14ea87712a3b479');

    });

    it("Decode response event with indexed", function () {

        $responseRaw = json_decode('{"address":"0x31b83a851eb7112448d4837a071acabd83531f69","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000e78102df96419cd9c44d6bd8f14ea87712a3b479","0x000000000000000000000000e9875966d7d6490592db866f815faf6fa94225a6"],"data":"0x000000000000000000000000000000000000000000000000000000000000002a","blockNumber":"0x5577e","transactionHash":"0x1654c3343501d4cdb78ddd52da8e86c5f700ed13a8cdf71e7b6544b7483c8559","transactionIndex":"0x0","blockHash":"0x0b675c0fab32f0ab0221c309145b7b27571f335aa49518c05d71b4d8d1771a80","logIndex":"0x0","removed":false}',true);
        $reponseData = $this->scDrt->decodeEventResponse($responseRaw);

        expect($reponseData['eventName'])->to->equal('Approval');
        expect($reponseData['data']['owner']->getHex())->to->equal('e78102df96419cd9c44d6bd8f14ea87712a3b479');
        expect($reponseData['data']['spender']->getHex())->to->equal('e9875966d7d6490592db866f815faf6fa94225a6');
        expect($reponseData['data']['value']->getInt())->to->equal('42');

    });

});

