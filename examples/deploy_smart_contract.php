<?php

use EthereumRawTx\Tool\Hex;

require_once __DIR__ . '/../vendor/autoload.php';

$nonce = 9;
$smartContractBinaries = "6060604052341561000f57600080fd5b610b758061001e6000396000f3006060604052600436106100f1576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630b97bc86146100f65780630f7678721461011f57806316441813146101485780632014e5d11461017f5780634423c5f1146101ac578063454a2ab3146102285780634c051f1414610263578063544736e6146102b85780636f52a711146102e55780637b3529621461030e5780637d9f6db51461033b57806382dd9b7714610350578063971c92a814610380578063bef4876b146103a9578063c24a0f8b146103d6578063e53dbd7a146103ff578063efbe1c1c14610428575b600080fd5b341561010157600080fd5b61010961043d565b6040518082815260200191505060405180910390f35b341561012a57600080fd5b610132610443565b6040518082815260200191505060405180910390f35b341561015357600080fd5b61015b610449565b60405180848152602001838152602001828152602001935050505060405180910390f35b341561018a57600080fd5b610192610462565b604051808215151515815260200191505060405180910390f35b34156101b757600080fd5b6101cd6004808035906020019091905050610482565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018481526020018381526020018215151515815260200194505050505060405180910390f35b341561023357600080fd5b61024960048080359060200190919050506104ee565b604051808215151515815260200191505060405180910390f35b341561026e57600080fd5b6102766107ba565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156102c357600080fd5b6102cb610864565b604051808215151515815260200191505060405180910390f35b34156102f057600080fd5b6102f8610871565b6040518082815260200191505060405180910390f35b341561031957600080fd5b610321610877565b604051808215151515815260200191505060405180910390f35b341561034657600080fd5b61034e61089a565b005b341561035b57600080fd5b61036361092a565b604051808381526020018281526020019250505060405180910390f35b341561038b57600080fd5b6103936109c2565b6040518082815260200191505060405180910390f35b34156103b457600080fd5b6103bc6109c7565b604051808215151515815260200191505060405180910390f35b34156103e157600080fd5b6103e96109da565b6040518082815260200191505060405180910390f35b341561040a57600080fd5b6104126109e0565b6040518082815260200191505060405180910390f35b341561043357600080fd5b61043b6109e5565b005b60015481565b60025481565b6000806000600154925060005491506004549050909192565b600061046c610864565b801561047d575061047b610877565b155b905090565b60058181548110151561049157fe5b90600052602060002090600402016000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010154908060020154908060030160009054906101000a900460ff16905084565b6000806104f961092a565b915050610504610462565b151561051357600091506107b4565b8083101561063d576005805480600101828161052f9190610aad565b916000526020600020906004020160006080604051908101604052803373ffffffffffffffffffffffffffffffffffffffff16815260200187815260200142815260200160001515815250909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015560608201518160030160006101000a81548160ff0219169083151502179055505050507f3f3880a3434edc55799b6fa2eb84de9f6b4364947a45ded791bac94deae3c0a1836040518082815260200191505060405180910390a1600091506107b4565b600580548060010182816106519190610aad565b916000526020600020906004020160006080604051908101604052803373ffffffffffffffffffffffffffffffffffffffff16815260200187815260200142815260200160011515815250909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015560608201518160030160006101000a81548160ff0219169083151502179055505050507feeb046b305fcff3538cfdefcb3ce223663ef84836df9830a1de00bc00817631e8382604051808381526020018281526020019250505060405180910390a160b4600054034211156107af5760b442016000819055507fe95bc45419aec7c2c587ae26906bc5d0cd55ce4237d73476f63bc13b36b149556000546040518082815260200191505060405180910390a15b600191505b50919050565b60008060058054905090505b60008114151561085f576005600182038154811015156107e257fe5b906000526020600020906004020160030160009054906101000a900460ff16156108515760056001820381548110151561081857fe5b906000526020600020906004020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169150610860565b8080600190039150506107c6565b5b5090565b6000600154421015905090565b60045481565b6000600360009054906101000a900460ff1680610895575060005442115b905090565b6005600281905550620f4240600181905550621e8480600081905550621e84806004819055506000600360006101000a81548160ff0219169083151502179055507f0114aab713235b737f82de882833e128d244e12c1b0967b9c49748c123a6f4b160025460015460005460405180848152602001838152602001828152602001935050505060405180910390a1565b600080600060058054905090505b6000811415156109b75760056001820381548110151561095457fe5b906000526020600020906004020160030160009054906101000a900460ff16156109a95760056001820381548110151561098a57fe5b90600052602060002090600402016001015492506001830191506109bd565b808060019003915050610938565b60025491505b509091565b60b481565b600360009054906101000a900460ff1681565b60005481565b60b481565b600080600360009054906101000a900460ff161580610a05575060005442105b15610a0f57610aa9565b6001600360006101000a81548160ff021916908315150217905550610a3261092a565b915091507f8b1ad6c69d3d79a05f5b1ec0de825e9bf67c6c70b8c25babd159976cf9990dff610a5f6107ba565b83604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a15b5050565b815481835581811511610ada57600402816004028360005260206000209182019101610ad99190610adf565b5b505050565b610b4691905b80821115610b4257600080820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055600182016000905560028201600090556003820160006101000a81549060ff021916905550600401610ae5565b5090565b905600a165627a7a723058204c3ead2e7c464e8b47077ed9328e1b345ae56ec1ae10681d2c5b0c1e0a37ff0d0029";

$pk = getenv("PHP_ETH_RAW_TX_PK");
if (!$pk) {
    exit("/!\ Set private key in PHP_ETH_RAW_TX_PK env var" . PHP_EOL);
}

$chainId = 4; // rinkeby

$tx = new \EthereumRawTx\Transaction(
    null,
    null,
    $smartContractBinaries,
    $nonce,
    40000000000,
    1000000
);

$raw = $tx->getRaw($pk, $chainId);

echo "Generated raw transaction :" . PHP_EOL;
echo $raw . PHP_EOL;